<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="com.spring.mvc_mybatis.ch05.dao.UserDAO_ch05">
 
	<resultMap id="userMap" type="com.spring.mvc_mybatis.ch05.dto.UserDTO_5">
		<id property="userId" column="user_id"/>
		<result property="userName" column="user_name"/>
		<result property="regDate" column="reg_date"/>
	</resultMap> 
 
 	<!-- 목록조회 -->
 	<select id="selectUserList" resultMap="userMap">
 		SELECT user_id
 			 , user_name
 			 , reg_date
 		  FROM mvc_user_tbl
 		ORDER BY user_id ASC
 	</select>
 	
 	<select id="selectUser" parameterType="int" resultMap="userMap">
 		SELECT user_id
 			 , user_name
 			 , reg_date
 		  FROM mvc_user_tbl
 		 WHERE user_id = #{userId}
 	</select>
 	
 	<!-- insert후 목록처리 -->
 	<!-- jdbcType : null값이 들어올 수 있으므로 jdbcType 설정 -->
 	<insert id="insertUser" parameterType="com.spring.mvc_mybatis.ch05.dto.UserDTO_5">
      INSERT INTO mvc_user_tbl(user_id, user_name, reg_date)
       VALUES(#{userId, jdbcType=NUMERIC}, #{userName, jdbcType=VARCHAR}, #{regDate, jdbcType=DATE})  <!-- null 처리 -->
   </insert>
   
   <update id="updateUser" parameterType="com.spring.mvc_mybatis.ch05.dto.UserDTO_5">
   		UPDATE mvc_user_tbl
   		<set>
   			<if test="userName != null"> user_name = #{userName},</if>
   			<if test="regDate != null"> reg_date = #{regDate}</if>
   		</set>
		 WHERE user_id = #{userId}
   </update>
   
   	<delete id="deleteUser" parameterType="int">
	   DELETE FROM mvc_user_tbl
	    WHERE user_id = #{userId}
     </delete>
 </mapper>